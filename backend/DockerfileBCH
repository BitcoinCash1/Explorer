FROM node:lts-slim

ARG commitHash
ENV MEMPOOL_COMMIT_HASH=${commitHash}

WORKDIR /backend

USER node

RUN chown node:node ./
COPY --chown=node:node dist ./package/

EXPOSE 8999

HEALTHCHECK --interval=20s --timeout=16s --start-period=10s \
  CMD node package/healthcheck.js

CMD node package/index.js
